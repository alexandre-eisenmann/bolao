<!DOCTYPE html>
<html>
<head>
  <script src="d3.v3.min.js" charset="utf-8"></script>
  <script src="jquery-2.1.1.min.js" charset="utf-8"></script>
  <script src="data.js" charset="utf-8"></script>
  <script src="bolao.js" charset="utf-8"></script>
  <link rel="stylesheet" type="text/css" href="bolao.css">
</head>
<body>

  <div class="header">
    <div id="game-1" class="game done">
      <div class="left">BRA</div>
      <div class="right">CRO</div>
      <div class="left-gols bra">3</div>
      <div class="right-gols cro">1</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-2" class="game done">
      <div class="left">MEX</div>
      <div class="right">CAM</div>
      <div class="left-gols mex">1</div>
      <div class="right-gols cmr">0</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-3" class="game done">
      <div class="left">ESP</div>
      <div class="right">HOL</div>
      <div class="left-gols esp">1</div>
      <div class="right-gols ned">5</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-4" class="game done">
      <div class="left">CHI</div>
      <div class="right">AUS</div>
      <div class="left-gols chi">3</div>
      <div class="right-gols aus">1</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-5" class="game done">
      <div class="left">COL</div>
      <div class="right">GRE</div>
      <div class="left-gols col">3</div>
      <div class="right-gols gre">0</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-7"  class="game done">
      <div class="left">URU</div>
      <div class="right">COS</div>
      <div class="left-gols uru">1</div>
      <div class="right-gols crc">3</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-8" class="game done">
      <div class="left">ING</div>
      <div class="right">ITA</div>
      <div class="left-gols eng">1</div>
      <div class="right-gols ita">2</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-6" class="game done">
      <div class="left">CDM</div>
      <div class="right">JAP</div>
      <div class="left-gols civ">2</div>
      <div class="right-gols jpn">1</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-9" class="game done">
      <div class="left">SUI</div>
      <div class="right">EQU</div>
      <div class="left-gols sui">2</div>
      <div class="right-gols ecu">1</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-10" class="game done">
      <div class="left">FRA</div>
      <div class="right">HON</div>
      <div class="left-gols fra">3</div>
      <div class="right-gols hon">0</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-11"  class="game done">
      <div class="left">ARG</div>
      <div class="right">BOS</div>
      <div class="left-gols arg">2</div>
      <div class="right-gols bih">1</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-13" class="game done">
      <div class="left">ALE</div>
      <div class="right">POR</div>
      <div class="left-gols ger">4</div>
      <div class="right-gols por">0</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-12" class="game done">
      <div class="left">IRA</div>
      <div class="right">NIG</div>
      <div class="left-gols irn">0</div>
      <div class="right-gols nga">0</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-14" class="game done">
      <div class="left">GAN</div>
      <div class="right">EUA</div>
      <div class="left-gols gha">1</div>
      <div class="right-gols usa">2</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-15" class="game done">
      <div class="left">BEL</div>
      <div class="right">AGL</div>
      <div class="left-gols bel">2</div>
      <div class="right-gols alg">1</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-17" class="game done">
      <div class="left">BRA</div>
      <div class="right">MEX</div>
      <div class="left-gols bra">0</div>
      <div class="right-gols mex">0</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-16" class="game done">
      <div class="left">RUS</div>
      <div class="right">COR</div>
      <div class="left-gols rus">1</div>
      <div class="right-gols kor">1</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-20" class="game done">
      <div class="left">AUS</div>
      <div class="right">HOL</div>
      <div class="left-gols aus">2</div>
      <div class="right-gols ned">3</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-19" class="game done">
      <div class="left">ESP</div>
      <div class="right">CHI</div>
      <div class="left-gols esp">0</div>
      <div class="right-gols chi">2</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-18" class="game done">
      <div class="left">CRO</div>
      <div class="right">CAM</div>
      <div class="left-gols cro">4</div>
      <div class="right-gols cmr">0</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-21" class="game done">
      <div class="left">COL</div>
      <div class="right">CDM</div>
      <div class="left-gols col">2</div>
      <div class="right-gols civ">1</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-23" class="game done">
      <div class="left">URU</div>
      <div class="right">ING</div>
      <div class="left-gols uru">2</div>
      <div class="right-gols eng">1</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-22" class="game done">
      <div class="left">JAP</div>
      <div class="right">GRE</div>
      <div class="left-gols jpn">0</div>
      <div class="right-gols gre">0</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-24" class="game done">
      <div class="left">ITA</div>
      <div class="right">COS</div>
      <div class="left-gols ita">0</div>
      <div class="right-gols crc">1</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-25" class="game done">
      <div class="left">SUI</div>
      <div class="right">FRA</div>
      <div class="left-gols sui">2</div>
      <div class="right-gols fra">5</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-26" class="game done">
      <div class="left">HON</div>
      <div class="right">EQU</div>
      <div class="left-gols hon">1</div>
      <div class="right-gols ecu">2</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-27" class="game done">
      <div class="left">ARG</div>
      <div class="right">IRA</div>
      <div class="left-gols arg">1</div>
      <div class="right-gols ira">0</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-29" class="game done">
      <div class="left">ALE</div>
      <div class="right">GAN</div>
      <div class="left-gols ger">2</div>
      <div class="right-gols gha">2</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-28" class="game done">
      <div class="left">NIG</div>
      <div class="right">BOS</div>
      <div class="left-gols nga">1</div>
      <div class="right-gols bih">0</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-31" class="game done">
      <div class="left">BEL</div>
      <div class="right">RUS</div>
      <div class="left-gols bel">1</div>
      <div class="right-gols rus">0</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-32" class="game done">
      <div class="left">COR</div>
      <div class="right">AGL</div>
      <div class="left-gols kor">2</div>
      <div class="right-gols alg">4</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-30" class="game done">
      <div class="left">EUA</div>
      <div class="right">POR</div>
      <div class="left-gols usa">2</div>
      <div class="right-gols por">2</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-35" class="game done">
      <div class="left">AUS</div>
      <div class="right">ESP</div>
      <div class="left-gols aus">0</div>
      <div class="right-gols esp">3</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-36" class="game done">
      <div class="left">HOL</div>
      <div class="right">CHI</div>
      <div class="left-gols ned">2</div>
      <div class="right-gols chi">0</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-33" class="game done">
      <div class="left">CAM</div>
      <div class="right">BRA</div>
      <div class="left-gols cmr">1</div>
      <div class="right-gols bra">4</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-34" class="game done">
      <div class="left">CRO</div>
      <div class="right">MEX</div>
      <div class="left-gols cro">1</div>
      <div class="right-gols mex">3</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-40" class="game done">
      <div class="left">COS</div>
      <div class="right">ING</div>
      <div class="left-gols crc">0</div>
      <div class="right-gols eng">0</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-39" class="game done">
      <div class="left">ITA</div>
      <div class="right">URU</div>
      <div class="left-gols ita">0</div>
      <div class="right-gols uru">1</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-38" class="game done">
      <div class="left">GRE</div>
      <div class="right">CDM</div>
      <div class="left-gols gre">2</div>
      <div class="right-gols civ">1</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-37" class="game done">
      <div class="left">JAP</div>
      <div class="right">COL</div>
      <div class="left-gols jpn">1</div>
      <div class="right-gols col">4</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-44" class="game done">
      <div class="left">BOS</div>
      <div class="right">IRA</div>
      <div class="left-gols bih">3</div>
      <div class="right-gols irn">1</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div  id="game-43" class="game done">
      <div class="left">NIG</div>
      <div class="right">ARG</div>
      <div class="left-gols nga">2</div>
      <div class="right-gols arg">3</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-42" class="game done">
      <div class="left">EQU</div>
      <div class="right">FRA</div>
      <div class="left-gols ecu">0</div>
      <div class="right-gols fra">0</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-41" class="game done">
      <div class="left">HON</div>
      <div class="right">SUI</div>
      <div class="left-gols hon">0</div>
      <div class="right-gols sui">3</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-46" class="game done">
      <div class="left">POR</div>
      <div class="right">GAN</div>
      <div class="left-gols hon">2</div>
      <div class="right-gols sui">1</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-45" class="game done">
      <div class="left">EUA</div>
      <div class="right">ALE</div>
      <div class="left-gols usa">0</div>
      <div class="right-gols ger">1</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-48" class="game done">
      <div class="left">AGL</div>
      <div class="right">RUS</div>
      <div class="left-gols agl">1</div>
      <div class="right-gols rus">1</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
    <div id="game-47" class="game done">
      <div class="left">COR</div>
      <div class="right">BEL</div>
      <div class="left-gols kor">0</div>
      <div class="right-gols bel">1</div>
      <div class="stats0"></div>
      <div class="stats3"></div>
      <div class="stats5"></div>
      <div class="stats8"></div>
    </div>
  </div>
  <div class="botoes" >
    <div id="stepfast" class="botao clickable">Estou com pressa</div>
    <div id="step" class="botao clickable">Calcular proximo jogo</div>
  </div>
  <div id="jogos"></div>
  <div id="resultados"></div>

<script type="text/javascript">







var selectGame = getParameterByName("selectGame");

function updateStats(gameElement, stats) {
     gameElement.find('.stats0').html(stats[0]);
     gameElement.find('.stats3').html(stats[3]);
     gameElement.find('.stats5').html(stats[5]);
     gameElement.find('.stats8').html(stats[8]);
}

function  calculateGames(gamesArray, updateFunction) {
  if (gamesArray && gamesArray.length == 0)
    return

  var game = gamesArray[0];

  if (!game.left || !game.right) {
    game.left  = game.element.find('.left-gols').html();
    game.right = game.element.find('.right-gols').html();
    if (!game.left || !game.right) {
      return;
    }
  }
  game.element.toggleClass("calculando");

  updateFunction(game.left, game.right, function(stats) {
     updateStats(game.element, stats);
     game.element.toggleClass("calculando");
     game.element.toggleClass("calculado");
     if (gamesArray.length == 1) {
       game.element.toggleClass("select-game");
     }
     calculateGames(gamesArray.slice(1), updateFunction);


  })
}


$( document ).ready(function() {

   sort();
   start();
   var update = buildUpdate(6);

    mode = 'pressa';
    rainDuration = 0;
    sortDuration = 0;
    goLeftDuration = 0;
    assyncDurationDown = 0;
    assyncDurationUp = 0;
    pointsDuration = 0;

   var canCalculate=true;
   var toBeCalculated = [];

   $(".game").each(function() {
      var jqGame = $(this);
      var left = jqGame.find('.left').html();
      var right = jqGame.find('.right').html();
      var leftGols = jqGame.find('.left-gols').html();
      var rightGols = jqGame.find('.right-gols').html();

      var game = (left+""+right).toLowerCase();
      var results = getParameterByName(game).split("-");

      if (results && results.length==2) {
        leftGols = results[0];
        rightGols = results[1];
        $(this).find('.left-gols').html(leftGols);
        $(this).find('.right-gols').html(rightGols);
      }

      if (canCalculate) {
        toBeCalculated.push({left: leftGols, right: rightGols, element: jqGame, name: game});
      }

      if (selectGame && selectGame == game) {
        canCalculate=false;
      }


    });

    calculateGames(toBeCalculated, update);






    var process = function() {

        var botao  = $(this).attr("id");
        if (!$(this).hasClass("clickable"))
          return;


        if (botao == "stepfast") {
          mode = 'pressa';
          rainDuration = 0;
          sortDuration = 0;
          goLeftDuration = 0;
          assyncDurationDown = 0;
          assyncDurationUp = 0;
          pointsDuration = 0;

        } else {
          mode = 'animacao';
          rainDuration = 1000;
          sortDuration = 500;
          goLeftDuration = 50;
          assyncDurationDown = 30;
          assyncDurationUp = 10;
          pointsDuration = 20;
        }






       var selectGame = $(".select-game").first();
       var game;
       if (selectGame.length > 0 ) {
         game = selectGame.next()
       } else {
         game = $(".game").first()
       }

       var leftGols = game.find('.left-gols').html();
       var rightGols = game.find('.right-gols').html();

       if (leftGols && rightGols) {
         $(this).toggleClass("clickable");

         if (selectGame.length > 0 ) selectGame.toggleClass("select-game")
         game.toggleClass("select-game");

         update(leftGols, rightGols, function(stats) {
            $("#"+ botao).toggleClass("clickable");
            updateStats(game, stats);
            $(window).scrollTop(0);
         });
      }
    }

    $(".clickable").click(process);

    $(".left-controllers .menos").click(function() {

      var value = parseInt($(this).parent().find('.left-gols').html());
      if (value > 0) value--; else value = 0;
      $(this).parent().find('.left-gols').html(value);

    });

    $(".left-controllers .mais").click(function() {
      var value = parseInt($(this).parent().find('.left-gols').html());
      if (value >= 0) value++; else value = 0;
      $(this).parent().find('.left-gols').html(value);

    });

    $(".right-controllers .menos").click(function() {

      var value = parseInt($(this).parent().find('.right-gols').html());
      if (value > 0) value--; else value = 0;
      $(this).parent().find('.right-gols').html(value);

    });

    $(".right-controllers .mais").click(function() {
      var value = parseInt($(this).parent().find('.right-gols').html());
      if (value >= 0) value++; else value = 0;
      $(this).parent().find('.right-gols').html(value);

    });



     $(document.body).on('click', '.done', function() {
      var jqGame = $(this);
      var left = jqGame.find('.left').html();
      var right = jqGame.find('.right').html();
      if (window.location.href.indexOf('selectGame=')>=0) {
        window.location.href = window.location.href.replace(/(selectGame=)[^\&]+/, '$1' +(left + ""+right).toLowerCase());
      } else {
        window.location.href = window.location.href + "?selectGame="+(left+""+right).toLowerCase();
      }
     $()


    });


});

</script>
</body>
</html>
